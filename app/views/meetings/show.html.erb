<h1>Meeting: <%= @meeting.room_name %></h1>

<div id="jitsi" style="height: 600px; width: 100%; border: 1px solid #ccc;"></div>
<script src="<%= @jitsi_js %>"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const domain = "<%= @ipv4 %>:8443"; // no https here for Jitsi API  
  const options = {
    roomName: "<%= @meeting.room_name %>",
    width: "100%",
    height: 600,
    parentNode: document.querySelector('#jitsi'),
    configOverwrite: {},
    interfaceConfigOverwrite: {}
  };

  const api = new JitsiMeetExternalAPI(domain, options);

  api.addEventListener('videoConferenceJoined', () => {
    console.log('Joined the meeting!');
  });
});
</script>